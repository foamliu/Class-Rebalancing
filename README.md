# 类别再平衡

在分类问题中，不同类别数量不均衡是很常见的问题。本文尝试用代码示例的方式，讲清楚其造成的影响和解决之道。

## 造成影响
为什么样本不平衡会对结果造成影响呢？ 假设训练样本有4类，数量为:

类别 | 数量 |
|---|---|
|1|1|
|1|10|
|1|100|
|1|1000|

使用交叉熵作为损失函数:

```math
\sum_{i} t_i*log(p_i)
```

分类器若对每个样本都预测为类别x, 则平均损失为：

类别 | 损失 |
|---|---|
|1|18.404100479328054|
|2|18.254878043009175|
|3|16.76265367982039|
|4|1.8404100479327707|

## 类别再平衡

假设按照每类样本数量计算权值，进行再平衡：

w_1 = 1111/1
w_2 = 1111/10
w_3 = 1111/100
w_4 = 1111/1000

计算损失函数是考虑权值：

```math
\sum_{i} t_i*log(p_i)
```

则在分类器若对每个样本都预测为相同类别是平均损失为：

类别 | 损失 |
|---|---|
|1|55.26204142785614|
|2|55.26204142785614|
|3|55.26204142785614|
|4|55.26204142785614|